npm warn Unknown project config "store-dir". This will stop working in the next major version of npm.
npm warn Unknown project config "child-concurrency". This will stop working in the next major version of npm.
npm warn Unknown project config "package-import-method". This will stop working in the next major version of npm.
npm warn Unknown project config "network-timeout". This will stop working in the next major version of npm.
[dotenv@17.2.3] injecting env (50) from .env.local -- tip: ≡ƒöÉ prevent committing .env to code: https://dotenvx.com/precommit
[dotenv@17.2.3] injecting env (0) from .env -- tip: ≡ƒæÑ sync secrets across teammates & machines: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env.local -- tip: ≡ƒùé∩╕Å backup and recover secrets: https://dotenvx.com/ops
[dotenv@17.2.3] injecting env (0) from .env -- tip: ΓÜÖ∩╕Å  override existing env vars with { override: true }
[Scoring Test] Running detailed scoring with word marking...
[Scoring Agent] Starting scoring for Read Aloud
[RAG] Retrieving criteria for: read_aloud
[Tool] Transcribing audio: https://0bnqt3onuegvdmxo.public.blob.vercel-storage.com/test/speaking-audit-bNJ9fZ0a6BgiqHCchFztmN0i8Q4r2i.m4a
[Tool] Fetching audio from: https://0bnqt3onuegvdmxo.public.blob.vercel-storage.com/test/speaking-audit-bNJ9fZ0a6BgiqHCchFztmN0i8Q4r2i.m4a
[Scoring Agent] Preprocessing complete.
[Scoring Agent] Transcript: In recent years, significant changes in diet and lifestyle have led to a sharp rise in heart related illnesses. What's more concerning is that these conditions are longer limited to older adults, but now affecting younger people. To Strokes are among the most common heart issues, with symptoms like chest pain, weakness and heart attacks.
[Scoring Agent] Dispatching parallel expert reviews...
[Scoring Agent] Phonetic Expert failed: InvalidPromptError [AI_InvalidPromptError]: Invalid prompt: The messages must be a ModelMessage[]. If you have passed a UIMessage[], you can use convertToModelMessages to convert them.
    at standardizePrompt (C:\Users\lemon\Documents\GitHub\app\node_modules\.pnpm\ai@5.0.116_zod@4.2.1\node_modules\ai\src\prompt\standardize-prompt.ts:72:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
    at async fn (C:\Users\lemon\Documents\GitHub\app\node_modules\.pnpm\ai@5.0.116_zod@4.2.1\node_modules\ai\src\generate-object\generate-object.ts:295:36)
    ... 4 lines matching cause stack trace ...
    at async testDetailedScoring (C:\Users\lemon\Documents\GitHub\app\lib\ai\test-detailed-scoring.ts:18:24) {
  cause: _TypeValidationError [AI_TypeValidationError]: Type validation failed: Value: [{"role":"system","content":"You are an expert PTE Phonetic examiner focusing on Oral Fluency and Pronunciation.\n            Evaluate the rhythm, stress, and clarity.\n            If audio data is provided, use it to assess phonetic quality."},{"role":"user","content":[{"type":"text","text":"Evaluate the following submission:\nTranscript: In recent years, significant changes in diet and lifestyle have led to a sharp rise in heart related illnesses. What's more concerning is that these conditions are longer limited to older adults, but now affecting younger people. To Strokes are among the most common heart issues, with symptoms like chest pain, weakness and heart attacks.\nCriteria: \n        **Read Aloud Scoring Criteria:**\n        - **Content (5 points):** Does the speaker include all words from the text? Omissions or insertions differ.\n        - **Oral Fluency (5 points):** Rhythm, phrasing, and stress. No hesitations or repetitions.\n        - **Pronunciation (5 points):** Intelligibility and clarity. Vowels and consonants are produced correctly.\n    "},{"type":"file","data":"https://0bnqt3onuegvdmxo.public.blob.vercel-storage.com/test/speaking-audit-bNJ9fZ0a6BgiqHCchFztmN0i8Q4r2i.m4a","mimeType":"audio/mp4"}]}].
  Error message: [{"code":"invalid_union","errors":[[{"code":"invalid_value","values":["system"],"path":["role"],"message":"Invalid input: expected \"system\""},{"expected":"string","code":"invalid_type","path":["content"],"message":"Invalid input: expected string, received array"}],[{"code":"invalid_union","errors":[[{"expected":"string","code":"invalid_type","path":[],"message":"Invalid input: expected string, received array"}],[{"code":"invalid_union","errors":[[{"code":"invalid_value","values":["text"],"path":["type"],"message":"Invalid input: expected \"text\""},{"expected":"string","code":"invalid_type","path":["text"],"message":"Invalid input: expected string, received undefined"}],[{"code":"invalid_value","values":["image"],"path":["type"],"message":"Invalid input: expected \"image\""},{"code":"invalid_union","errors":[[{"code":"invalid_union","errors":[[{"expected":"string","code":"invalid_type","path":[],"message":"Invalid input: expected string, received undefined"}],[{"code":"custom","path":[],"message":"Input not instance of Uint8Array"}],[{"code":"custom","path":[],"message":"Input not instance of ArrayBuffer"}],[{"code":"custom","path":[],"message":"Must be a Buffer"}]],"path":[],"message":"Invalid input"}],[{"code":"custom","path":[],"message":"Input not instance of URL"}]],"path":["image"],"message":"Invalid input"}],[{"expected":"string","code":"invalid_type","path":["mediaType"],"message":"Invalid input: expected string, received undefined"}]],"path":[1],"message":"Invalid input"}]],"path":["content"],"message":"Invalid input"}],[{"code":"invalid_value","values":["assistant"],"path":["role"],"message":"Invalid input: expected \"assistant\""},{"code":"invalid_union","errors":[[{"expected":"string","code":"invalid_type","path":[],"message":"Invalid input: expected string, received array"}],[{"code":"invalid_union","errors":[[{"code":"invalid_value","values":["text"],"path":["type"],"message":"Invalid input: expected \"text\""},{"expected":"string","code":"invalid_type","path":["text"],"message":"Invalid input: expected string, received undefined"}],[{"expected":"string","code":"invalid_type","path":["mediaType"],"message":"Invalid input: expected string, received undefined"}],[{"code":"invalid_value","values":["reasoning"],"path":["type"],"message":"Invalid input: expected \"reasoning\""},{"expected":"string","code":"invalid_type","path":["text"],"message":"Invalid input: expected string, received undefined"}],[{"code":"invalid_value","values":["tool-call"],"path":["type"],"message":"Invalid input: expected \"tool-call\""},{"expected":"string","code":"invalid_type","path":["toolCallId"],"message":"Invalid input: expected string, received undefined"},{"expected":"string","code":"invalid_type","path":["toolName"],"message":"Invalid input: expected string, received undefined"}],[{"code":"invalid_value","values":["tool-result"],"path":["type"],"message":"Invalid input: expected \"tool-result\""},{"expected":"string","code":"invalid_type","path":["toolCallId"],"message":"Invalid input: expected string, received undefined"},{"expected":"string","code":"invalid_type","path":["toolName"],"message":"Invalid input: expected string, received undefined"},{"code":"invalid_type","expected":"object","path":["output"],"message":"Invalid input: expected object, received undefined"}]],"path":[1],"message":"Invalid input"}]],"path":["content"],"message":"Invalid input"}],[{"code":"invalid_value","values":["tool"],"path":["role"],"message":"Invalid input: expected \"tool\""},{"code":"invalid_value","values":["tool-result"],"path":["content",0,"type"],"message":"Invalid input: expected \"tool-result\""},{"expected":"string","code":"invalid_type","path":["content",0,"toolCallId"],"message":"Invalid input: expected string, received undefined"},{"expected":"string","code":"invalid_type","path":["content",0,"toolName"],"message":"Invalid input: expected string, received undefined"},{"code":"invalid_type","expected":"object","path":["content",0,"output"],"message":"Invalid input: expected object, received undefined"},{"code":"invalid_value","values":["tool-result"],"path":["content",1,"type"],"message":"Invalid input: expected \"tool-result\""},{"expected":"string","code":"invalid_type","path":["content",1,"toolCallId"],"message":"Invalid input: expected string, received undefined"},{"expected":"string","code":"invalid_type","path":["content",1,"toolName"],"message":"Invalid input: expected string, received undefined"},{"code":"invalid_type","expected":"object","path":["content",1,"output"],"message":"Invalid input: expected object, received undefined"}]],"path":[1],"message":"Invalid input"}]
      at Object.validate (C:\Users\lemon\Documents\GitHub\app\node_modules\.pnpm\@ai-sdk+provider-utils@3.0.19_zod@4.2.1\node_modules\@ai-sdk\provider-utils\src\validator.ts:110:18)
      at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
      at async safeValidateTypes (C:\Users\lemon\Documents\GitHub\app\node_modules\.pnpm\@ai-sdk+provider-utils@3.0.19_zod@4.2.1\node_modules\@ai-sdk\provider-utils\src\validate-types.ts:63:20)
      at async standardizePrompt (C:\Users\lemon\Documents\GitHub\app\node_modules\.pnpm\ai@5.0.116_zod@4.2.1\node_modules\ai\src\prompt\standardize-prompt.ts:66:28)
      at async fn (C:\Users\lemon\Documents\GitHub\app\node_modules\.pnpm\ai@5.0.116_zod@4.2.1\node_modules\ai\src\generate-object\generate-object.ts:295:36)
      at async <anonymous> (C:\Users\lemon\Documents\GitHub\app\node_modules\.pnpm\ai@5.0.116_zod@4.2.1\node_modules\ai\src\telemetry\record-span.ts:18:22)
      at async generateObject (C:\Users\lemon\Documents\GitHub\app\node_modules\.pnpm\ai@5.0.116_zod@4.2.1\node_modules\ai\src\generate-object\generate-object.ts:261:12)
      at async Promise.allSettled (index 1)
      at async scorePteAttemptV2 (C:\Users\lemon\Documents\GitHub\app\lib\ai\scoring-agent.ts:57:58)
      at async testDetailedScoring (C:\Users\lemon\Documents\GitHub\app\lib\ai\test-detailed-scoring.ts:18:24) {
    cause: [ [Object] ],
    value: [ [Object], [Object] ],
    Symbol(vercel.ai.error): true,
    Symbol(vercel.ai.error.AI_TypeValidationError): true
  },
  prompt: {
    system: undefined,
    prompt: undefined,
    messages: [ [Object], [Object] ]
  },
  Symbol(vercel.ai.error): true,
  Symbol(vercel.ai.error.AI_InvalidPromptError): true
}
[Error] Scoring test failed: Error: Phonetic Expert Review failed: Invalid prompt: The messages must be a ModelMessage[]. If you have passed a UIMessage[], you can use convertToModelMessages to convert them.
    at scorePteAttemptV2 (C:\Users\lemon\Documents\GitHub\app\lib\ai\scoring-agent.ts:148:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
    at async testDetailedScoring (C:\Users\lemon\Documents\GitHub\app\lib\ai\test-detailed-scoring.ts:18:24)
